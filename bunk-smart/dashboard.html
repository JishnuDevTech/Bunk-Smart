<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bunk Smart | Dashboard</title>
  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/dashboard.css">
  <link rel="stylesheet" href="css/attendance.css">
  <link rel="stylesheet" href="css/insights.css">
  <link rel="stylesheet" href="css/challenges.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2 class="brand">Bunk Smart</h2>
      <div class="user-info">
        <div class="user-avatar">
          <span id="user-initial">U</span>
        </div>
        <div class="user-details">
          <div class="user-name" id="user-name">Loading...</div>
          <div class="user-email" id="user-email">Loading...</div>
        </div>
      </div>
    </div>

    <nav class="sidebar-nav">
      <a href="#attendance" class="nav-item active" data-section="attendance">
        <span class="nav-icon">ğŸ“…</span>
        <span class="nav-text">Attendance</span>
      </a>
      <a href="#insights" class="nav-item" data-section="insights">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Insights</span>
      </a>
      <a href="#challenges" class="nav-item" data-section="challenges">
        <span class="nav-icon">ğŸ¯</span>
        <span class="nav-text">Challenges</span>
      </a>
      <a href="#settings" class="nav-item" data-section="settings">
        <span class="nav-icon">âš™ï¸</span>
        <span class="nav-text">Settings</span>
      </a>
    </nav>

    <div class="sidebar-footer">
      <button id="signout-btn" class="signout-btn">
        <span class="signout-icon">ğŸšª</span>
        <span class="signout-text">Sign Out</span>
      </button>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <main class="main-content">

    <!-- ATTENDANCE SECTION -->
    <section id="attendance-section" class="content-section active">
      <div class="section-header">
        <h1>Attendance Dashboard</h1>
        <p>Track your daily attendance and build consistent habits</p>
      </div>

      <div class="stats-cards">
        <div class="stat-card">
          <div class="stat-icon">ğŸ“Š</div>
          <div class="stat-info">
            <div class="stat-value" id="attendance-rate">0%</div>
            <div class="stat-label">Attendance Rate</div>
          </div>
        </div>
      <div class="stat-card">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <div class="stat-value" id="present-days">0</div>
          <div class="stat-label">Present Days</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">âŒ</div>
        <div class="stat-info">
          <div class="stat-value" id="bunk-days">0</div>
          <div class="stat-label">Bunk Days</div>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ğŸ“ˆ</div>
        <div class="stat-info">
          <div class="stat-value" id="streak">0</div>
          <div class="stat-label">Day Streak</div>
        </div>
      </div>
      </div>

      <div class="attendance-container">
        <header class="month-header">
          <button id="prev-month">&lt;</button>
          <h3 id="current-month">January 2026</h3>
          <button id="next-month">&gt;</button>
        </header>

        <div class="calendar-grid" id="calendar-grid">
          <!-- Calendar will be generated by JS -->
        </div>
      </div>
    </section>

    <!-- INSIGHTS SECTION -->
    <section id="insights-section" class="content-section">
      <div class="section-header">
        <h1>Attendance Insights</h1>
        <p>Analyze your attendance patterns and identify improvement areas</p>
      </div>

      <div class="insights-container">
        <div class="insights-summary">
          <div class="summary-card">
            <h3>Monthly Overview</h3>
            <div class="summary-stats">
              <div class="summary-stat">
                <span class="stat-number" id="monthly-present">0</span>
                <span class="stat-label">Present</span>
              </div>
              <div class="summary-stat">
                <span class="stat-number" id="monthly-bunk">0</span>
                <span class="stat-label">Bunk</span>
              </div>
              <div class="summary-stat">
                <span class="stat-number" id="monthly-rate">0%</span>
                <span class="stat-label">Rate</span>
              </div>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="attendance-chart" width="400" height="200"></canvas>
        </div>

        <div class="export-buttons">
          <button id="export-csv" class="btn-secondary">Export CSV</button>
          <button id="export-pdf" class="btn-secondary">Export PDF</button>
        </div>

        <div class="bunk-cards" id="bunk-cards">
          <!-- Bunk insights will be generated by JS -->
        </div>
      </div>
    </section>

    <!-- CHALLENGES SECTION -->
    <section id="challenges-section" class="content-section">
      <div class="section-header">
        <h1>Challenges</h1>
        <p>Take on challenges to build discipline and consistency</p>
      </div>

      <div class="challenges-container">
        <div class="challenge-card" data-challenge="30_days_hard">
          <h4>30 Days Hard</h4>
          <p>Daily discipline. No excuses.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-30_days_hard">Day 0/30</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-30_days_hard">Start Challenge</button>
            <button class="check-in-btn" id="checkin-30_days_hard" hidden>Mark Today</button>
            <span class="badge" id="badge-30_days_hard" hidden>ğŸ† Completed!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="60_days_hard">
          <h4>60 Days Hard</h4>
          <p>Consistency over motivation.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-60_days_hard">Day 0/60</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-60_days_hard">Start Challenge</button>
            <button class="check-in-btn" id="checkin-60_days_hard" hidden>Mark Today</button>
            <span class="badge" id="badge-60_days_hard" hidden>ğŸ† Completed!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="90_days_hard">
          <h4>90 Days Hard</h4>
          <p>Identity-level discipline.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-90_days_hard">Day 0/90</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-90_days_hard">Start Challenge</button>
            <button class="check-in-btn" id="checkin-90_days_hard" hidden>Mark Today</button>
            <span class="badge" id="badge-90_days_hard" hidden>ğŸ† Completed!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="10_tasks_rage">
          <h4>10 Tasks Rage</h4>
          <p>Finish 10 tasks without stopping.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-10_tasks_rage">Task 0/10</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-10_tasks_rage">Start Challenge</button>
            <button class="check-in-btn" id="checkin-10_tasks_rage" hidden>Complete Task</button>
            <span class="badge" id="badge-10_tasks_rage" hidden>ğŸ† Completed!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="7_day_streak">
          <h4>7-Day Streak</h4>
          <p>Maintain 7 consecutive present days.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-7_day_streak">Streak: 0/7</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-7_day_streak">Start Challenge</button>
            <span class="badge" id="badge-7_day_streak" hidden>ğŸ”¥ Streak Master!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="no_bunk_week">
          <h4>No Bunk Week</h4>
          <p>Zero bunks for an entire week.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-no_bunk_week">Days: 0/7</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-no_bunk_week">Start Challenge</button>
            <span class="badge" id="badge-no_bunk_week" hidden>ğŸ’ª Discipline King!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="perfect_month">
          <h4>Perfect Month</h4>
          <p>100% attendance for the month.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-perfect_month">Attendance: 0%</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-perfect_month">Start Challenge</button>
            <span class="badge" id="badge-perfect_month" hidden>â­ Perfect!</span>
          </div>
        </div>

        <div class="challenge-card" data-challenge="custom_challenge">
          <h4>Custom Challenge</h4>
          <p>Create your own goal.</p>
          <div class="progress-info">
            <span class="progress-text" id="progress-custom_challenge">Setup Required</span>
            <div class="progress-bar" style="--progress: 0%"></div>
          </div>
          <div class="challenge-actions">
            <button class="start-challenge" id="start-custom_challenge">Customize</button>
            <span class="badge" id="badge-custom_challenge" hidden>ğŸ¨ Personalized Win!</span>
          </div>
        </div>
      </div>
    </section>

    <!-- SETTINGS SECTION -->
    <section id="settings-section" class="content-section">
      <div class="section-header">
        <h1>Settings</h1>
        <p>Customize your Bunk Smart experience</p>
      </div>

      <div class="settings-container">
        <div class="settings-group">
          <h3>Profile Settings</h3>
          <div class="setting-item">
            <label for="display-name">Display Name</label>
            <input type="text" id="display-name" placeholder="Your display name">
          </div>
          <div class="setting-item">
            <label for="email-notifications">Email Notifications</label>
            <input type="checkbox" id="email-notifications" checked>
          </div>
          <div class="setting-item">
            <label for="push-notifications">Push Notifications</label>
            <input type="checkbox" id="push-notifications" checked>
          </div>
          <div class="setting-item">
            <label for="reminder-time">Daily Reminder Time</label>
            <input type="time" id="reminder-time" value="09:00">
          </div>
        </div>

        <div class="settings-group">
          <h3>App Preferences</h3>
          <div class="setting-item">
            <label for="theme">Theme</label>
            <select id="theme">
              <option value="light">Light</option>
              <option value="dark">Dark</option>
              <option value="auto">Auto (System)</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="start-week">Week Starts On</label>
            <select id="start-week">
              <option value="sunday">Sunday</option>
              <option value="monday">Monday</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="language">Language</label>
            <select id="language">
              <option value="en">English</option>
              <option value="es">Spanish</option>
              <option value="fr">French</option>
              <option value="de">German</option>
              <option value="hi">Hindi</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="timezone">Timezone</label>
            <select id="timezone">
              <option value="UTC">UTC</option>
              <option value="America/New_York">Eastern Time</option>
              <option value="America/Chicago">Central Time</option>
              <option value="America/Denver">Mountain Time</option>
              <option value="America/Los_Angeles">Pacific Time</option>
              <option value="Europe/London">London</option>
              <option value="Europe/Paris">Paris</option>
              <option value="Asia/Tokyo">Tokyo</option>
              <option value="Asia/Kolkata">India (IST)</option>
            </select>
          </div>
        </div>

        <div class="settings-group">
          <h3>Attendance Settings</h3>
          <div class="setting-item">
            <label for="default-attendance">Default Attendance Status</label>
            <select id="default-attendance">
              <option value="present">Present</option>
              <option value="absent">Absent</option>
              <option value="ask">Ask Each Time</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="attendance-reminder">Attendance Reminders</label>
            <input type="checkbox" id="attendance-reminder" checked>
          </div>
          <div class="setting-item">
            <label for="streak-goal">Monthly Attendance Goal (%)</label>
            <input type="number" id="streak-goal" min="0" max="100" value="95">
          </div>
          <div class="setting-item">
            <label for="working-days">Working Days</label>
            <div class="checkbox-group">
              <label><input type="checkbox" name="working-days" value="monday" checked> Mon</label>
              <label><input type="checkbox" name="working-days" value="tuesday" checked> Tue</label>
              <label><input type="checkbox" name="working-days" value="wednesday" checked> Wed</label>
              <label><input type="checkbox" name="working-days" value="thursday" checked> Thu</label>
              <label><input type="checkbox" name="working-days" value="friday" checked> Fri</label>
              <label><input type="checkbox" name="working-days" value="saturday"> Sat</label>
              <label><input type="checkbox" name="working-days" value="sunday"> Sun</label>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h3>Privacy & Security</h3>
          <div class="setting-item">
            <label for="data-sharing">Share Anonymous Usage Data</label>
            <input type="checkbox" id="data-sharing">
          </div>
          <div class="setting-item">
            <label for="two-factor">Two-Factor Authentication</label>
            <input type="checkbox" id="two-factor">
          </div>
          <div class="setting-item">
            <label for="session-timeout">Auto Logout (minutes)</label>
            <select id="session-timeout">
              <option value="15">15 minutes</option>
              <option value="30">30 minutes</option>
              <option value="60" selected>1 hour</option>
              <option value="240">4 hours</option>
              <option value="0">Never</option>
            </select>
          </div>
        </div>

        <div class="settings-group">
          <h3>Data Management</h3>
          <div class="setting-item">
            <label for="auto-backup">Auto Backup Data</label>
            <input type="checkbox" id="auto-backup" checked>
          </div>
          <div class="setting-item">
            <label for="backup-frequency">Backup Frequency</label>
            <select id="backup-frequency">
              <option value="daily">Daily</option>
              <option value="weekly" selected>Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
          </div>
          <div class="data-actions">
            <button class="btn-secondary" id="export-data">
              <span class="btn-icon">ğŸ“¥</span>
              Export Data
            </button>
            <button class="btn-secondary" id="import-data">
              <span class="btn-icon">ğŸ“¤</span>
              Import Data
            </button>
            <button class="btn-danger" id="clear-data">
              <span class="btn-icon">ğŸ—‘ï¸</span>
              Clear All Data
            </button>
          </div>
        </div>

        <div class="settings-group">
          <h3>Support & Help</h3>
          <div class="setting-item">
            <button class="btn-secondary" id="help-center">
              <span class="btn-icon">â“</span>
              Help Center
            </button>
            <button class="btn-secondary" id="contact-support">
              <span class="btn-icon">ğŸ“§</span>
              Contact Support
            </button>
            <button class="btn-secondary" id="report-issue">
              <span class="btn-icon">ğŸ›</span>
              Report Issue
            </button>
          </div>
        </div>
      </div>
    </section>

  </main>

  <!-- ATTENDANCE MODAL -->
  <div class="modal" id="attendance-modal" hidden>
    <div class="modal-content">
      <button class="modal-close" id="modal-close">&times;</button>
      <h3>Mark Attendance</h3>
      <p id="selected-date">Select a date</p>

      <div class="attendance-options">
        <button class="attendance-btn present-btn" id="mark-present">
          <span class="btn-icon">âœ…</span>
          <span>Present</span>
        </button>
        <button class="attendance-btn bunk-btn" id="mark-bunk">
          <span class="btn-icon">âŒ</span>
          <span>Bunked</span>
        </button>
      </div>

      <div class="bunk-details" id="bunk-details" hidden>
        <label>What I did instead</label>
        <input type="text" id="bunk-activity" placeholder="e.g., Built a project">

        <label>What I missed</label>
        <input type="text" id="bunk-missed" placeholder="e.g., DBMS lecture">
      </div>

      <button id="save-attendance" class="btn-primary">Save Attendance</button>
    </div>
  </div>

  <script type="module" src="js/firebase.js"></script>
  <script src="js/storage.js"></script>
  <script type="module" src="js/guard.js"></script>
  <script type="module" src="js/dashboard.js"></script>

</body>
</html>
